---
const { article } = Astro.props;

// Explicit logo mapping for every provider (typed in frontmatter)
const logoMap = {
  'OpenAI': '/logos/OpenAI_logo.svg',
  'Meta AI': '/logos/Meta_logo.svg',
  'Anthropic': '/logos/Anthropic_logo.svg',
  'Google DeepMind': '/logos/DeepMind_logo.svg',
  'Mistral AI': '/logos/Mistral_logo.svg',
  'Hugging Face': '/logos/Hugging_Face_logo.svg',
  'xAI': '/logos/Xai_logo.svg',
} as const;

const company = String(article?.company ?? '');
const logoPath = (logoMap as Record<string, string>)[company];
---
<article class="glassmorphic-article-card article-card-hoverable animated-gradient p-6 mb-8 transition-colors duration-700 bg-transparent" >
  <div style="position:relative; z-index:3;">
    <div class="flex items-center gap-2 mb-2">
      {logoPath ? (
        <span class="w-7 h-7 rounded-full bg-gradient-to-br from-[oklch(0.74_0.04_260_/_0.9)] via-[oklch(0.85_0.14_180_/_0.18)] to-[oklch(0.40_0.05_260_/_0.6)] ring-2 ring-brand/40 shadow-[0_0_12px_2px_oklch(0.80_0.12_205_/_0.08)] mr-2 flex items-center justify-center">
          <img src={logoPath} alt={article.company + ' logo'} class="w-5 h-5 rounded-full" width="20" height="20" decoding="async" loading="lazy" onerror="this.style.display='none'" />
        </span>
      ) : null}
      <span class="text-brand font-semibold text-base">{article.company}</span>
      <span class="text-text-2 text-sm ml-2">{new Date(article.published_at).toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: 'numeric' })}</span>
    </div>
    <h2 class="text-lg font-bold text-text-1 m-0">
      <a href={article.url} target="_blank" rel="noopener noreferrer" class="hover:text-brand underline">
        {article.title}
      </a>
    </h2>
    {article.source_type && (
      <span class="ml-auto px-3 py-1 rounded-full text-xs font-semibold source-chip">
        {article.source_type}
      </span>
    )}
    <p class="text-sm text-text-2 mb-2">{article.summary}</p>
    <div class="flex items-center justify-between text-xs text-white/60 mt-4">
      <button class="absolute top-4 right-4 text-text-2 hover:text-brand-hover transition-colors" aria-label="Dismiss">
        <svg width="20" height="20" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M18 6 6 18M6 6l12 12"/></svg>
      </button>
    </div>
  </div>
</article>
<style>
.animated-gradient {
  background: linear-gradient(
    120deg,
    oklch(0.20 0.04 260) 0%, /* Navy tint */
    oklch(0.85 0.14 180 / 0.06) 50%, /* Teal tint */
    oklch(0.84 0.13 230 / 0.06) 100% /* Blue tint */
  );
  background-size: 200% 200%;
  animation: gradientMove 24s ease-in-out infinite;
}
@keyframes gradientMove {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}
/* Green accent chip for source type */
.source-chip {
  background-color: oklch(0.86 0.14 150 / 0.18);
  color: oklch(0.78 0.16 150);
  border: 1px solid oklch(0.78 0.16 150 / 0.35);
}
</style>
